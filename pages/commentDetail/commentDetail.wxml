<view class="content">
  <view class="left">
    <image class="img" mode="aspectFill" src="{{ detail.avatar }}"></image>
  </view>
  <view class="right">
    <view class="top">
      <text class="line name">{{ detail.nickname }}</text>
      <view class="time-del">
        <text class="line time">{{ detail.createtimes }}</text>
        <view class="del" wx:if="{{ $state.userInfo.id == detail.uid }}" catchtap="showModal">
          <image src="{{ $state.imgHost }}/delete.png" mode="aspectFill" class="icon-del"></image>
          <text>删除</text>
        </view>
      </view>
    </view>
    <rich-text nodes="{{ detail.content }}"></rich-text>
    <button wx:if="{{ $state.userInfo.id != detail.uid }}" class="reply-btn" catchtap="show">回复</button>
  </view>
</view>
<view class="children" wx:for="{{ detail.reply_array }}" wx:key="index" wx:for-item="child">
  <view class="from_user">
    <view class="user_info">
      <image class="img" mode="aspectFill" src="{{ child.from_user_avatar }}"></image>
      <text class="line name">{{ child.from_user }}</text>
    </view>
    <view class="time-del">
      <text class="line time">{{ child.create_time }}</text>
      <view class="del" wx:if="{{ $state.userInfo.id == child.reply_user_id }}" catchtap="showModal" data-item="{{ child }}">
        <image src="{{ $state.imgHost }}/delete.png" mode="aspectFill" class="icon-del"></image>
        <text>删除</text>
      </view>
    </view>
  </view>
  <rich-text nodes="{{ child.rtext + child.reply_content }}"></rich-text>
  <button wx:if="{{ $state.userInfo.id != child.reply_user_id }}" class="reply-btn" data-reply="{{ child }}" catchtap="show">回复</button>
</view>

<view class="popup write" wx:if="{{ write }}">
  <view class="bg" bindtap="hide"></view>
  <view class="box">
    <textarea placeholder="写评论" focus cursor-spacing="190rpx" fixed bindinput="input" value="{{ content }}" placeholder-class="ph-class"></textarea>
    <view class="right" catchtap="toComment">
      <view class="to">
        <image mode="aspectFit" class="icon" src="{{ $state.imgHost }}/screen.png"></image>
      </view>
      <button class="release" disabled="{{ !content }}" catchtap="release">发布</button>
    </view>
  </view>
</view>
